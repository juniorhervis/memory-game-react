name: Projeto DevOps

on:
  push:
    branches: [master]

jobs:
  build-job:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 16
      - run: npm ci

  teste-job:
    needs: build-job
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: AppThreat/sast-scan-action@master

  deploy-job:
    needs: teste-job
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: echo Hello World
      - name: Ngrok Tunnel Action
        # You may pin to the exact commit or the version.
        # uses: LuisBoto/ngrok-tunnel-action@354358d72c11d68bbdf419e55c6864a8921b3c2e
        uses: LuisBoto/ngrok-tunnel-action@v0.1.7.2
        with:        
          tunnel_type: http          
          port: 3000          
          save_url_to_filename: 'url.txt'          
          ngrok_authtoken: ${{ secrets.NGROK_AUTHTOKEN }}
